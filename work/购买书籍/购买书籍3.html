<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="shop1.css">

</head>

<body>
    <div id="container" class="container">
        <div>
            <ul>
                <li data-id="0" draggable="true">
                    <img src="image/img1.jpg">
                    <p>javaScript语言精髓</p>
                    <span>¥20.68</span>
                </li>
                <li data-id="1" draggable="true">
                    <img src="image/img2.jpg">
                    <p>javaScript权威指南</p>
                    <span>¥5.66</span>
                </li>
                <li data-id="2" draggable="true">
                    <img src="image/img3.jpg">
                    <p>精通javaScript</p>
                    <span>¥30.00</span>
                </li>
                <li data-id="3" draggable="true">
                    <img src="image/img4.jpg">
                    <p>javaScript DOM 编程艺术</p>
                    <span>¥28.50</span>
                </li>
            </ul>
        </div>
    </div>

    <div id="shopCar" class="shopCar">
        <ul>
            <li>
                <span>数量</span>
                <span>书名</span>
                <span>价格</span>
            </li>
            <div id="priceSum"><span style="left: 0;">0</span> : 总价</div>
        </ul>
    </div>
</body>
<script>
    let json = [{
        id: 0,
        imgsrc: "image/img1.jpg",
        bookname: "javaScript语言精髓",
        price: "20.68",
    }, {
        id: 1,
        imgsrc: "image/img2.jpg",
        bookname: "javaScript权威指南",
        price: "5.66",
    }, {
        id: 2,
        imgsrc: "image/img3.jpg",
        bookname: "精通javaScript",
        price: "30.00",
    }, {
        id: 3,
        imgsrc: "image/img4.jpg",
        bookname: "javaScript DOM 编程艺术",
        price: "28.50",
    }]

    let goodsLi = document.querySelectorAll(".container div ul");
    let shopCar = document.querySelector(".shopCar ul")
        //存储购物车里面的数据
    let shopCarData = [];
    //正在被拖动的书
    let dragObj = null;

    //对所有书都绑定一个拖拽事件
    for (let i = 0; i < goodsLi.length; i++) {
        goodsLi[i].addEventListener("dragstart", function(e) {
            json.map(e => {
                //
                if (String(e.id) === String(this.getAttribute("data-id"))) {
                    dragObj = e
                    console.log(e.id + this.getAttribute("data-id"));
                }
            })
        })
    }

    //为shopCar可以接受丢弃的内容做准备 因为默认任何元素是不可以拖曳且不可以接收拖曳的内容
    shopCar.addEventListener("dragover", function(e) {
        //本身是不让接收拖曳 但是现在我想拖曳 所以我允许拖曳 阻止浏览器默认事件发生
        e.preventDefault();
    })

    //drop 丢弃事件
    shopCar.addEventListener("drop", function() {
        //判断拖曳的对象在不在结果数组中
        dropShopCar(shopCarData)
    })

    //把书丢进去，然后在购物车添加丢进去的书
    function dropShopCar(shopCarData) {
        shopCar.innerHTML = ""
        shopCarData.map(e => {
            shopCar.innerHTML +=
                `
                <li data-id="${e.id}">
                        <img src="${e.imgsrc}" />
                        <span>${e.bookname}</span>
                        <span>${e.price}</span>
                        <span>${e.count}</span>
                    </li>
            `
        })
    }
</script>

</html>