<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
    <style>
        .tab {
            margin: 100px auto;
            width: 400px;
        }
        
        * {
            padding: 0;
            margin: 0
        }
        
        ul {
            list-style: none;
        }
        
        .tab .tab_title {
            overflow: hidden;
        }
        
        .tab .tab_title li {
            background-color: gray;
            color: white;
            /* width: 100px; */
            text-align: center;
            padding: 5px;
            box-sizing: border-box;
            cursor: pointer;
            float: left;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }
        
        .tab .tab_title .clicked {
            background-color: skyblue;
            white-space: nowrap;
            overflow: visible;
            text-overflow: string;
        }
        
        .tab .tab_content li {
            border: 3px solid rgb(210, 210, 210);
            /* width: 300px; */
            height: 200px;
            padding: 20px;
            box-sizing: border-box;
            background-color: gray;
            display: none;
        }
        
        .tab .tab_content .active {
            display: block;
        }
    </style>
</head>

<body>
    <div class="tab" id="haha">
    </div>
    <script>
        // let _random = (min, max, digits) => {
        //     let num;
        //     //仅有一个参数的时候 0-min
        //     if (!max) {
        //         num = Math.random() * min
        //     } else {
        //         //min,max
        //         num = Math.random() * (max - min) + min
        //     }
        //     if (digits === "undefined" || digits === 0) {
        //         num = Math.floor(num)
        //     } else {
        //         num = Number(num.toFixed(digits))
        //     }
        //     return num
        // }

        /**
         * 
         * @param {HTMLElment} parent 父元素 
         * @param {String} eleName 待添加标签的名字 
         * @param {String} value 标签中的内容 
         * @param {Object} attr 这个子标签的属性对象 
         */

        // let _append = (parent, eleName, value = "", attr) => {
        //     if (Object.prototype.toString.call(parent) === "[object String]") {
        //         let parent = document.getElementById(parent)
        //     }
        //     //1 生产一个li标签
        //     let newEle = document.createElement(eleName)
        //     for (let key in attr) {
        //         newEle.setAttribute(key, attr[key])
        //     }
        //     //2. 生产一个文本节点
        //     // let newTxt = document.createTextNode(value);
        //     newEle.innerHTML = value
        //         //3. 拼接
        //     parent.appendChild(newEle)
        //         // newEle.appendChild(newTxt)
        //     return newEle
        // }



        class Tab {
            constructor(parent, data) {
                    this.parent = parent;
                    this.title = "tab_title"
                    this.content = "tab_content"
                    this.data = data
                    this.init()
                }
                //初始化一个选项卡
            init() {
                let oParent = document.querySelector(`#${this.parent}`);
                oParent.innerHTML =
                    `
                    <ul class="${this.title}" id="${this.title}"></ul>
                    <ul class="${this.content}" id="${this.content}"></ul>
                    `
                let titleUl = this.initTitle()
                this.titleClick(titleUl)
                this.initContent()
            }

            initTitle() {
                    let oTitle = document.querySelector(`#${this.title}`)
                    this.data.map((e, i) => {
                        //做一个自定义属性
                        if (i !== 0) {
                            oTitle.innerHTML += `<li title="${e.title}" index="${i}">${e.title}</li>`
                        } else {
                            oTitle.innerHTML += `<li title="${e.title}" class="${Tab.TITLE_ACTIVE}" index="${i}">${e.title}</li>`
                        }
                    })
                    let aTitle = oTitle.getElementsByTagName("li");
                    // console.log(oTitle.offsetWidth)
                    for (let i = 0; i < aTitle.length; i++) {
                        aTitle[i].style.width = (oTitle.offsetWidth - 50) / aTitle.length + "px";
                    }
                    aTitle[0].style.width = aTitle[0].offsetWidth + 50 + "px"
                    return oTitle
                }
                //为title的ul绑定一个点击事件
            titleClick(ul) {
                ul.addEventListener("click", (e) => {
                    this.reset(this.parent)
                    this.change(e.target)
                })
            }

            //洗掉所有的样式
            reset() {
                    let aTitle = document.querySelectorAll(`#${this.title} li`)
                    let aContent = document.querySelectorAll(`#${this.content} li`)
                    for (let i = 0; i < aTitle.length; i++) {
                        aTitle[i].className = ""
                        aContent[i].className = ""
                    }
                }
                //修改对应的li的样式
            change(li) {
                if (li.nodeName === "LI") {
                    let aTitle = document.querySelectorAll(`#${this.title} li`)
                    let aContent = document.querySelectorAll(`#${this.content} li`)
                    let oTitle = document.querySelector(`#${this.title}`)
                    aTitle[li.getAttribute("index")].className = "clicked"
                    aContent[li.getAttribute("index")].className = "active"
                    for (let i = 0; i < aTitle.length; i++) {
                        aTitle[i].style.width = (oTitle.offsetWidth - 50) / aTitle.length + "px";
                    }
                    aTitle[li.getAttribute("index")].style.width = aTitle[li.getAttribute("index")].offsetWidth + 50 + "px"
                }
            }

            initContent() {
                let oContent = document.querySelector(`#${this.content}`)
                this.data.map((e, i) => {
                    if (i !== 0) {
                        oContent.innerHTML += `<li>${e.content}</li>`
                    } else {
                        oContent.innerHTML += `<li class=${Tab.CONTENT_ACTIVE}>${e.content}</li>`
                    }
                })
            }
        }

        Tab.TITLE_ACTIVE = "clicked"
        Tab.CONTENT_ACTIVE = "active"


        let json = [{
            "title": "标题一",
            "content": "“中国创新能力不断提升”"
        }, {
            "title": "标题二",
            "content": "“必须竭尽所能避免和减少污名化”"
        }, {
            "title": "标题三",
            "content": "海关总署：健康申明卡网上申报超380万票"
        }, {
            "title": "标题四",
            "content": "还是撒和撒谎时"
        }, {
            "title": "标题五",
            "content": "555555555555555555"
        }, {
            "title": "标题五",
            "content": "555555555555555555"
        }, {
            "title": "标题五",
            "content": "555555555555555555"
        }]
        new Tab("haha", json)
    </script>
</body>

</html>